var operators={"+":{precedence:2,associativity:"left-to-right"},"-":{unary:{precedence:5,associativity:"right-to-left"},binary:{precedence:2,associativity:"left-to-right"}},"*":{precedence:4,associativity:"left-to-right"},"/":{precedence:4,associativity:"left-to-right"},"^":{precedence:6,associativity:"right-to-left"}},is={whitespace:function(a){"use strict";return" "===a},separator:function(a){"use strict";return"."===a||","===a},numeric:function(a){"use strict";return!isNaN(parseFloat(a))&&isFinite(a)||is.separator(a)}},parsexpr={tokenize:function(a){"use strict";for(var b=[],c=0,d="",e="";c<a.length;){if(d=a.charAt(c),!is.whitespace(d))if(is.numeric(d)){for(e="",e+=d,c+=1;c<a.length&&is.numeric(a.charAt(c));)e+=a.charAt(c),c+=1;c-=1,b.push({token:e,type:"number"})}else if(operators.hasOwnProperty(d))"-"===d?0===b.length||"number"!==b[b.length-1].type&&"right_parenthesis"!==b[b.length-1].type?b.push({token:d,type:"unary_prefix",opType:operators["-"].unary}):b.push({token:d,type:"binary",opType:operators["-"].binary}):b.push({token:d,type:"binary",opType:operators[d]});else if("("===d)b.push({token:d,type:"left_parenthesis"});else{if(")"!==d)throw"Unknown operator in: "+a;b.push({token:d,type:"right_parenthesis"})}c+=1}return b},infixToPostfix:function(a){"use strict";for(var b=this.tokenize(a),c=[],d=[],e="";b.length>0;)if(e=b.shift(),"number"===e.type)c.push(e);else if("unary_prefix"===e.type)d.push(e);else if(operators.hasOwnProperty(e.token)){if("left-to-right"===e.opType.associativity){for(;d.length>0&&"left_parenthesis"!==d[d.length-1].type&&d[d.length-1].opType.precedence>=e.opType.precedence;)c.push(d.pop());d.push(e)}else if("right-to-left"===e.opType.associativity){for(;d.length>0&&"left_parenthesis"!==d[d.length-1].type&&d[d.length-1].opType.precedence>e.opType.precedence;)c.push(d.pop());d.push(e)}}else if("left_parenthesis"===e.type)d.push(e);else if("right_parenthesis"===e.type){for(;"left_parenthesis"!==d[d.length-1].type;)c.push(d.pop());if("left_parenthesis"!==d[d.length-1].type)throw"Mismatched brackets while converting to postfix in: "+b;d.pop()}for(;d.length>0;)c.push(d.pop());return d=null,c},evaluate:function(a){"use strict";for(var b=this.infixToPostfix(a),c=[],d="",e="";b.length>0;)if(d=b.shift(),"number"===d.type)c.push(parseFloat(d.token));else{if(!operators.hasOwnProperty(d.token))throw"Unknown token while evaluating in: "+b;e=c.pop(),"+"===d.token?c.push(c.pop()+e):"-"===d.token?"unary_prefix"===d.type?c.push(-1*e):"binary"===d.type&&c.push(c.pop()-e):"*"===d.token?c.push(c.pop()*e):"/"===d.token?c.push(c.pop()/e):"^"===d.token&&c.push(Math.pow(c.pop(),e))}return c[0]}};